‰
@C:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 
AddControllers		 
(		  
)		  !
;		! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDbContext *
>* +
(+ ,
options, 3
=>4 6
options 
. 	
UseSqlServer	 
( 
builder 
. 
Configuration +
.+ ,
GetConnectionString, ?
(? @
$str@ S
)S T
)T U
)U V
;V W
builder 
. 
Services 
. 
AddControllers 
(  
)  !
.! "
AddJsonOptions" 0
(0 1
options1 8
=>9 ;
{ 
options 
. 	!
JsonSerializerOptions	 
. 
ReferenceHandler /
=0 1
ReferenceHandler2 B
.B C
PreserveC K
;K L
options 
. 	!
JsonSerializerOptions	 
. 
WriteIndented ,
=- .
true/ 3
;3 4
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app!! 
.!! 
UseHttpsRedirection!! 
(!! 
)!! 
;!! 
app## 
.## 
UseAuthorization## 
(## 
)## 
;## 
app%% 
.%% 
MapControllers%% 
(%% 
)%% 
;%% 
app'' 
.'' 
Run'' 
('' 
)'' 	
;''	 
Ün
`C:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\Migrations\20250116150812_InitialCreate.cs
	namespace 	
CitasMedicas
 
. 

Migrations !
{ 
public		 

partial		 
class		 
InitialCreate		 &
:		' (
	Migration		) 2
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
	id_doctor 
= 
table  %
.% &
Column& ,
<, -
int- 0
>0 1
(1 2
type2 6
:6 7
$str8 =
,= >
nullable? G
:G H
falseI N
)N O
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
falseS X
)X Y
,Y Z
apellido 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
falseU Z
)Z [
,[ \
especialidad  
=! "
table# (
.( )
Column) /
</ 0
string0 6
>6 7
(7 8
type8 <
:< =
$str> M
,M N
nullableO W
:W X
falseY ^
)^ _
,_ `
telefono 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
trueU Y
)Y Z
,Z [
correo 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
trueS W
)W X
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
	id_doctor; D
)D E
;E F
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name   
:   
$str   !
,  ! "
columns!! 
:!! 
table!! 
=>!! !
new!!" %
{"" 
id_paciente## 
=##  !
table##" '
.##' (
Column##( .
<##. /
int##/ 2
>##2 3
(##3 4
type##4 8
:##8 9
$str##: ?
,##? @
nullable##A I
:##I J
false##K P
)##P Q
.$$ 

Annotation$$ #
($$# $
$str$$$ 8
,$$8 9
$str$$: @
)$$@ A
,$$A B
nombre%% 
=%% 
table%% "
.%%" #
Column%%# )
<%%) *
string%%* 0
>%%0 1
(%%1 2
type%%2 6
:%%6 7
$str%%8 G
,%%G H
nullable%%I Q
:%%Q R
false%%S X
)%%X Y
,%%Y Z
apellido&& 
=&& 
table&& $
.&&$ %
Column&&% +
<&&+ ,
string&&, 2
>&&2 3
(&&3 4
type&&4 8
:&&8 9
$str&&: I
,&&I J
nullable&&K S
:&&S T
false&&U Z
)&&Z [
,&&[ \
fecha_nacimiento'' $
=''% &
table''' ,
.'', -
Column''- 3
<''3 4
DateTime''4 <
>''< =
(''= >
type''> B
:''B C
$str''D O
,''O P
nullable''Q Y
:''Y Z
false''[ `
)''` a
,''a b
telefono(( 
=(( 
table(( $
.(($ %
Column((% +
<((+ ,
string((, 2
>((2 3
(((3 4
type((4 8
:((8 9
$str((: I
,((I J
nullable((K S
:((S T
true((U Y
)((Y Z
,((Z [
	direccion)) 
=)) 
table))  %
.))% &
Column))& ,
<)), -
string))- 3
>))3 4
())4 5
type))5 9
:))9 :
$str)); J
,))J K
nullable))L T
:))T U
true))V Z
)))Z [
,))[ \
correo** 
=** 
table** "
.**" #
Column**# )
<**) *
string*** 0
>**0 1
(**1 2
type**2 6
:**6 7
$str**8 G
,**G H
nullable**I Q
:**Q R
true**S W
)**W X
}++ 
,++ 
constraints,, 
:,, 
table,, "
=>,,# %
{-- 
table.. 
... 

PrimaryKey.. $
(..$ %
$str..% 3
,..3 4
x..5 6
=>..7 9
x..: ;
...; <
id_paciente..< G
)..G H
;..H I
}// 
)// 
;// 
migrationBuilder11 
.11 
CreateTable11 (
(11( )
name22 
:22 
$str22 
,22 
columns33 
:33 
table33 
=>33 !
new33" %
{44 
id_cita55 
=55 
table55 #
.55# $
Column55$ *
<55* +
int55+ .
>55. /
(55/ 0
type550 4
:554 5
$str556 ;
,55; <
nullable55= E
:55E F
false55G L
)55L M
.66 

Annotation66 #
(66# $
$str66$ 8
,668 9
$str66: @
)66@ A
,66A B
id_paciente77 
=77  !
table77" '
.77' (
Column77( .
<77. /
int77/ 2
>772 3
(773 4
type774 8
:778 9
$str77: ?
,77? @
nullable77A I
:77I J
false77K P
)77P Q
,77Q R
	id_doctor88 
=88 
table88  %
.88% &
Column88& ,
<88, -
int88- 0
>880 1
(881 2
type882 6
:886 7
$str888 =
,88= >
nullable88? G
:88G H
false88I N
)88N O
,88O P

fecha_hora99 
=99  
table99! &
.99& '
Column99' -
<99- .
DateTime99. 6
>996 7
(997 8
type998 <
:99< =
$str99> I
,99I J
nullable99K S
:99S T
false99U Z
)99Z [
,99[ \
estado:: 
=:: 
table:: "
.::" #
Column::# )
<::) *
string::* 0
>::0 1
(::1 2
type::2 6
:::6 7
$str::8 G
,::G H
nullable::I Q
:::Q R
true::S W
)::W X
,::X Y
descripcion;; 
=;;  !
table;;" '
.;;' (
Column;;( .
<;;. /
string;;/ 5
>;;5 6
(;;6 7
type;;7 ;
:;;; <
$str;;= L
,;;L M
nullable;;N V
:;;V W
true;;X \
);;\ ]
}<< 
,<< 
constraints== 
:== 
table== "
=>==# %
{>> 
table?? 
.?? 

PrimaryKey?? $
(??$ %
$str??% /
,??/ 0
x??1 2
=>??3 5
x??6 7
.??7 8
id_cita??8 ?
)??? @
;??@ A
table@@ 
.@@ 

ForeignKey@@ $
(@@$ %
nameAA 
:AA 
$strAA ;
,AA; <
columnBB 
:BB 
xBB  !
=>BB" $
xBB% &
.BB& '
	id_doctorBB' 0
,BB0 1
principalTableCC &
:CC& '
$strCC( 2
,CC2 3
principalColumnDD '
:DD' (
$strDD) 4
,DD4 5
onDeleteEE  
:EE  !
ReferentialActionEE" 3
.EE3 4
CascadeEE4 ;
)EE; <
;EE< =
tableFF 
.FF 

ForeignKeyFF $
(FF$ %
nameGG 
:GG 
$strGG >
,GG> ?
columnHH 
:HH 
xHH  !
=>HH" $
xHH% &
.HH& '
id_pacienteHH' 2
,HH2 3
principalTableII &
:II& '
$strII( 3
,II3 4
principalColumnJJ '
:JJ' (
$strJJ) 6
,JJ6 7
onDeleteKK  
:KK  !
ReferentialActionKK" 3
.KK3 4
CascadeKK4 ;
)KK; <
;KK< =
}LL 
)LL 
;LL 
migrationBuilderNN 
.NN 
CreateTableNN (
(NN( )
nameOO 
:OO 
$strOO &
,OO& '
columnsPP 
:PP 
tablePP 
=>PP !
newPP" %
{QQ 
id_procedimientoRR $
=RR% &
tableRR' ,
.RR, -
ColumnRR- 3
<RR3 4
intRR4 7
>RR7 8
(RR8 9
typeRR9 =
:RR= >
$strRR? D
,RRD E
nullableRRF N
:RRN O
falseRRP U
)RRU V
.SS 

AnnotationSS #
(SS# $
$strSS$ 8
,SS8 9
$strSS: @
)SS@ A
,SSA B
descripcionTT 
=TT  !
tableTT" '
.TT' (
ColumnTT( .
<TT. /
stringTT/ 5
>TT5 6
(TT6 7
typeTT7 ;
:TT; <
$strTT= L
,TTL M
nullableTTN V
:TTV W
falseTTX ]
)TT] ^
,TT^ _
costoUU 
=UU 
tableUU !
.UU! "
ColumnUU" (
<UU( )
decimalUU) 0
>UU0 1
(UU1 2
typeUU2 6
:UU6 7
$strUU8 G
,UUG H
nullableUUI Q
:UUQ R
falseUUS X
)UUX Y
,UUY Z
id_citaVV 
=VV 
tableVV #
.VV# $
ColumnVV$ *
<VV* +
intVV+ .
>VV. /
(VV/ 0
typeVV0 4
:VV4 5
$strVV6 ;
,VV; <
nullableVV= E
:VVE F
falseVVG L
)VVL M
}WW 
,WW 
constraintsXX 
:XX 
tableXX "
=>XX# %
{YY 
tableZZ 
.ZZ 

PrimaryKeyZZ $
(ZZ$ %
$strZZ% 8
,ZZ8 9
xZZ: ;
=>ZZ< >
xZZ? @
.ZZ@ A
id_procedimientoZZA Q
)ZZQ R
;ZZR S
table[[ 
.[[ 

ForeignKey[[ $
([[$ %
name\\ 
:\\ 
$str\\ ?
,\\? @
column]] 
:]] 
x]]  !
=>]]" $
x]]% &
.]]& '
id_cita]]' .
,]]. /
principalTable^^ &
:^^& '
$str^^( /
,^^/ 0
principalColumn__ '
:__' (
$str__) 2
,__2 3
onDelete``  
:``  !
ReferentialAction``" 3
.``3 4
Cascade``4 ;
)``; <
;``< =
}aa 
)aa 
;aa 
migrationBuildercc 
.cc 
CreateIndexcc (
(cc( )
namedd 
:dd 
$strdd *
,dd* +
tableee 
:ee 
$stree 
,ee 
columnff 
:ff 
$strff #
)ff# $
;ff$ %
migrationBuilderhh 
.hh 
CreateIndexhh (
(hh( )
nameii 
:ii 
$strii ,
,ii, -
tablejj 
:jj 
$strjj 
,jj 
columnkk 
:kk 
$strkk %
)kk% &
;kk& '
migrationBuildermm 
.mm 
CreateIndexmm (
(mm( )
namenn 
:nn 
$strnn 1
,nn1 2
tableoo 
:oo 
$stroo '
,oo' (
columnpp 
:pp 
$strpp !
)pp! "
;pp" #
}qq 	
	protectedtt 
overridett 
voidtt 
Downtt  $
(tt$ %
MigrationBuildertt% 5
migrationBuildertt6 F
)ttF G
{uu 	
migrationBuildervv 
.vv 
	DropTablevv &
(vv& '
nameww 
:ww 
$strww &
)ww& '
;ww' (
migrationBuilderyy 
.yy 
	DropTableyy &
(yy& '
namezz 
:zz 
$strzz 
)zz 
;zz 
migrationBuilder|| 
.|| 
	DropTable|| &
(||& '
name}} 
:}} 
$str}}  
)}}  !
;}}! "
migrationBuilder 
. 
	DropTable &
(& '
name
ÄÄ 
:
ÄÄ 
$str
ÄÄ !
)
ÄÄ! "
;
ÄÄ" #
}
ÅÅ 	
}
ÇÇ 
}ÉÉ Ó;
\C:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\Controllers\ProcedimientoController.cs
	namespace 	
CitasMedicas
 
. 
Controllers "
{		 
[

 
ApiController

 
]

 
[ 
Route 
( 
$str 
) 
] 
public 
class #
ProcedimientoController %
:& '
ControllerBase( 6
{ 
private 	
readonly
 
AppDbContext 
_context  (
;( )
public #
ProcedimientoController	  
(  !
AppDbContext! -
context. 5
)5 6
{ 
_context 
= 
context 
; 
} 
[ 
HttpGet 

]
 
public 
async	 
Task 
< 
ActionResult  
<  !
IEnumerable! ,
<, -
Procedimiento- :
>: ;
>; <
>< =
GetProcedimientos> O
(O P
)P Q
{ 
return 	
await
 
_context 
. 
Procedimientos '
.' (
Include( /
(/ 0
p0 1
=>2 4
p5 6
.6 7
Cita7 ;
); <
.< =
ToListAsync= H
(H I
)I J
;J K
} 
[ 
HttpGet 

(
 
$str 
) 
] 
public 
async	 
Task 
< 
ActionResult  
<  !
Procedimiento! .
>. /
>/ 0
GetProcedimiento1 A
(A B
intB E
idF H
)H I
{ 
var   
procedimiento   
=   
await   
_context   %
.  % &
Procedimientos  & 4
.  4 5
Include  5 <
(  < =
p  = >
=>  ? A
p  B C
.  C D
Cita  D H
)  H I
.!! 
FirstOrDefaultAsync!! $
(!!$ %
p!!% &
=>!!' )
p!!* +
.!!+ ,
id_procedimiento!!, <
==!!= ?
id!!@ B
)!!B C
;!!C D
if"" 
("" 
procedimiento"" 
=="" 
null"" 
)"" 
return"" $
NotFound""% -
(""- .
)"". /
;""/ 0
return## 	
procedimiento##
 
;## 
}$$ 
['' 
HttpPost'' 
]'' 
public(( 
async((	 
Task(( 
<(( 
ActionResult((  
<((  !
Procedimiento((! .
>((. /
>((/ 0
PostProcedimiento((1 B
(((B C
[((C D
FromBody((D L
]((L M
Procedimiento((N [
procedimiento((\ i
)((i j
{)) 
if** 
(** 
!** 

ModelState** 
.** 
IsValid** 
)** 
{++ 
return,, 


BadRequest,, 
(,, 

ModelState,,  
),,  !
;,,! "
}-- 
_context// 
.// 
Procedimientos// 
.// 
Add// 
(// 
procedimiento// ,
)//, -
;//- .
await00 
_context00	 
.00 
SaveChangesAsync00 "
(00" #
)00# $
;00$ %
return11 	
CreatedAtAction11
 
(11 
nameof11  
(11  !
GetProcedimiento11! 1
)111 2
,112 3
new114 7
{118 9
id11: <
=11= >
procedimiento11? L
.11L M
id_procedimiento11M ]
}11^ _
,11_ `
procedimiento11a n
)11n o
;11o p
}22 
[66 
HttpPut66 

(66
 
$str66 
)66 
]66 
public77 
async77	 
Task77 
<77 
IActionResult77 !
>77! "
PutProcedimiento77# 3
(773 4
int774 7
id778 :
,77: ;
[77< =
FromBody77= E
]77E F
Procedimiento77G T
procedimiento77U b
)77b c
{88 
if99 
(99 
id99 	
!=99
 
procedimiento99 
.99 
id_procedimiento99 +
)99+ ,
{:: 
return;; 


BadRequest;; 
(;; 
$str;; Y
);;Y Z
;;;Z [
}<< 
if>> 
(>> 
!>> 

ModelState>> 
.>> 
IsValid>> 
)>> 
{?? 
return@@ 


BadRequest@@ 
(@@ 

ModelState@@  
)@@  !
;@@! "
}AA 
_contextCC 
.CC 
EntryCC 
(CC 
procedimientoCC 
)CC  
.CC  !
StateCC! &
=CC' (
EntityStateCC) 4
.CC4 5
ModifiedCC5 =
;CC= >
tryEE 
{FF 
awaitGG 	
_contextGG
 
.GG 
SaveChangesAsyncGG #
(GG# $
)GG$ %
;GG% &
}HH 
catchII 
(II	 
(
DbUpdateConcurrencyExceptionII
 &
)II& '
{JJ 
ifKK 
(KK 
!KK 	
ProcedimientoExistsKK	 
(KK 
idKK 
)KK  
)KK  !
{LL 
returnMM 
NotFoundMM 
(MM 
)MM 
;MM 
}NN 
elseOO 
{PP 
throwQQ 

;QQ
 
}RR 
}SS 
returnUU 	
	NoContentUU
 
(UU 
)UU 
;UU 
}VV 
privateXX 	
boolXX
 
ProcedimientoExistsXX "
(XX" #
intXX# &
idXX' )
)XX) *
{YY 
returnZZ 	
_contextZZ
 
.ZZ 
ProcedimientosZZ !
.ZZ! "
AnyZZ" %
(ZZ% &
eZZ& '
=>ZZ( *
eZZ+ ,
.ZZ, -
id_procedimientoZZ- =
==ZZ> @
idZZA C
)ZZC D
;ZZD E
}[[ 
[__ 

HttpDelete__ 
(__ 
$str__ 
)__ 
]__ 
public`` 
async``	 
Task`` 
<`` 
IActionResult`` !
>``! "
DeleteProcedimiento``# 6
(``6 7
int``7 :
id``; =
)``= >
{aa 
varbb 
procedimientobb 
=bb 
awaitbb 
_contextbb %
.bb% &
Procedimientosbb& 4
.bb4 5
	FindAsyncbb5 >
(bb> ?
idbb? A
)bbA B
;bbB C
ifcc 
(cc 
procedimientocc 
==cc 
nullcc 
)cc 
returncc $
NotFoundcc% -
(cc- .
)cc. /
;cc/ 0
_contextdd 
.dd 
Procedimientosdd 
.dd 
Removedd !
(dd! "
procedimientodd" /
)dd/ 0
;dd0 1
awaitee 
_contextee	 
.ee 
SaveChangesAsyncee "
(ee" #
)ee# $
;ee$ %
returnff 	
	NoContentff
 
(ff 
)ff 
;ff 
}gg 
}hh 
}ii ¡:
XC:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\Controllers\PacientesController.cs
	namespace 	
CitasMedicas
 
. 
Controllers "
{		 
[

 
ApiController

 
]

 
[ 
Route 
( 
$str 
) 
] 
public 
class 
PacientesController !
:" #
ControllerBase$ 2
{ 
private 	
readonly
 
AppDbContext 
_context  (
;( )
public 
PacientesController	 
( 
AppDbContext )
context* 1
)1 2
{3 4
_context 
= 
context 
; 
} 
[ 
HttpGet 

]
 
public 
async	 
Task 
< 
ActionResult  
<  !
IEnumerable! ,
<, -
Paciente- 5
>5 6
>6 7
>7 8
GetPacientes9 E
(E F
)F G
{ 
return 	
await
 
_context 
. 
	Pacientes "
." #
ToListAsync# .
(. /
)/ 0
;0 1
} 
[ 
HttpGet 

(
 
$str 
) 
] 
public 
async	 
Task 
< 
ActionResult  
<  !
Paciente! )
>) *
>* +
GetPaciente, 7
(7 8
int8 ;
id< >
)> ?
{ 
var 
paciente 
= 
await 
_context  
.  !
	Pacientes! *
.* +
	FindAsync+ 4
(4 5
id5 7
)7 8
;8 9
if 
( 
paciente 
== 
null 
) 
return 
NotFound  (
(( )
)) *
;* +
return 	
paciente
 
; 
}   
["" 
HttpPost"" 
]"" 
public## 
async##	 
Task## 
<## 
ActionResult##  
<##  !
Paciente##! )
>##) *
>##* +
PostPaciente##, 8
(##8 9
[##9 :
FromBody##: B
]##B C
Paciente##D L
paciente##M U
)##U V
{$$ 
if%% 
(%% 
!%% 

ModelState%% 
.%% 
IsValid%% 
)%% 
{&& 
return'' 


BadRequest'' 
('' 

ModelState''  
)''  !
;''! "
}(( 
DateTime** 

fechaDeHoy** 
=** 
DateTime** !
.**! "
Today**" '
;**' (
if,, 
(,, 
paciente,, 
.,, 
fecha_nacimiento,,  
>,,! "

fechaDeHoy,,# -
),,- .
{-- 
return.. 


BadRequest.. 
(.. 
$str.. &
)..& '
;..' (
}// 
_context11 
.11 
	Pacientes11 
.11 
Add11 
(11 
paciente11 "
)11" #
;11# $
await22 
_context22	 
.22 
SaveChangesAsync22 "
(22" #
)22# $
;22$ %
return33 	
CreatedAtAction33
 
(33 
nameof33  
(33  !
GetPaciente33! ,
)33, -
,33- .
new33/ 2
{333 4
id335 7
=338 9
paciente33: B
.33B C
id_paciente33C N
}33O P
,33P Q
paciente33R Z
)33Z [
;33[ \
}44 
[77 
HttpPut77 

(77
 
$str77 
)77 
]77 
public88 
async88	 
Task88 
<88 
IActionResult88 !
>88! "
PutPaciente88# .
(88. /
int88/ 2
id883 5
,885 6
[887 8
FromBody888 @
]88@ A
Paciente88B J
paciente88K S
)88S T
{99 
if:: 
(:: 
id:: 	
!=::
 
paciente:: 
.:: 
id_paciente:: !
)::! "
{;; 
return<< 


BadRequest<< 
(<< 
$str<< Y
)<<Y Z
;<<Z [
}== 
if?? 
(?? 
!?? 

ModelState?? 
.?? 
IsValid?? 
)?? 
{@@ 
returnAA 


BadRequestAA 
(AA 

ModelStateAA  
)AA  !
;AA! "
}BB 
_contextDD 
.DD 
EntryDD 
(DD 
pacienteDD 
)DD 
.DD 
StateDD !
=DD" #
EntityStateDD$ /
.DD/ 0
ModifiedDD0 8
;DD8 9
tryFF 
{GG 
awaitHH 	
_contextHH
 
.HH 
SaveChangesAsyncHH #
(HH# $
)HH$ %
;HH% &
}II 
catchJJ 
(JJ	 
(
DbUpdateConcurrencyExceptionJJ
 &
)JJ& '
{KK 
ifLL 
(LL 
!LL 	
PacienteExistsLL	 
(LL 
idLL 
)LL 
)LL 
{MM 
returnNN 
NotFoundNN 
(NN 
)NN 
;NN 
}OO 
elsePP 
{QQ 
throwRR 

;RR
 
}SS 
}TT 
returnVV 	
	NoContentVV
 
(VV 
)VV 
;VV 
}WW 
privateYY 	
boolYY
 
PacienteExistsYY 
(YY 
intYY !
idYY" $
)YY$ %
{ZZ 
return[[ 	
_context[[
 
.[[ 
	Pacientes[[ 
.[[ 
Any[[  
([[  !
e[[! "
=>[[# %
e[[& '
.[[' (
id_paciente[[( 3
==[[4 6
id[[7 9
)[[9 :
;[[: ;
}\\ 
[`` 

HttpDelete`` 
(`` 
$str`` 
)`` 
]`` 
publicaa 
asyncaa	 
Taskaa 
<aa 
IActionResultaa !
>aa! "
DeletePacienteaa# 1
(aa1 2
intaa2 5
idaa6 8
)aa8 9
{bb 
varcc 
pacientecc 
=cc 
awaitcc 
_contextcc  
.cc  !
	Pacientescc! *
.cc* +
	FindAsynccc+ 4
(cc4 5
idcc5 7
)cc7 8
;cc8 9
ifdd 
(dd 
pacientedd 
==dd 
nulldd 
)dd 
returndd 
NotFounddd  (
(dd( )
)dd) *
;dd* +
_contextee 
.ee 
	Pacientesee 
.ee 
Removeee 
(ee 
pacienteee %
)ee% &
;ee& '
awaitff 
_contextff	 
.ff 
SaveChangesAsyncff "
(ff" #
)ff# $
;ff$ %
returngg 	
	NoContentgg
 
(gg 
)gg 
;gg 
}hh 
}ii 
}jj ‘6
UC:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\Controllers\DoctorController.cs
	namespace 	
CitasMedicas
 
. 
Controllers "
{		 
[

 
ApiController

 
]

 
[ 
Route 
( 
$str 
) 
] 
public 
class 
DoctorController 
: 
ControllerBase  .
{ 
private 	
readonly
 
AppDbContext 
_context  (
;( )
public 
DoctorController	 
( 
AppDbContext &
context' .
). /
{0 1
_context 
= 
context 
; 
} 
[ 
HttpGet 

]
 
public 
async	 
Task 
< 
ActionResult  
<  !
IEnumerable! ,
<, -
Doctor- 3
>3 4
>4 5
>5 6
GetDoctores7 B
(B C
)C D
{ 
return 	
await
 
_context 
. 
Doctores !
.! "
ToListAsync" -
(- .
). /
;/ 0
} 
[ 
HttpGet 

(
 
$str 
) 
] 
public 
async	 
Task 
< 
ActionResult  
<  !
Doctor! '
>' (
>( )
	GetDoctor* 3
(3 4
int4 7
id8 :
): ;
{ 
var 
doctor 
= 
await 
_context 
. 
Doctores '
.' (
	FindAsync( 1
(1 2
id2 4
)4 5
;5 6
if 
( 
doctor 
== 
null 
) 
return 
NotFound &
(& '
)' (
;( )
return 	
doctor
 
; 
}   
["" 
HttpPost"" 
]"" 
public## 
async##	 
Task## 
<## 
ActionResult##  
<##  !
Doctor##! '
>##' (
>##( )

PostDoctor##* 4
(##4 5
[##5 6
FromBody##6 >
]##> ?
Doctor##@ F
doctor##G M
)##M N
{$$ 
if%% 
(%% 
!%% 

ModelState%% 
.%% 
IsValid%% 
)%% 
{&& 
return'' 


BadRequest'' 
('' 

ModelState''  
)''  !
;''! "
}(( 
_context** 
.** 
Doctores** 
.** 
Add** 
(** 
doctor** 
)**  
;**  !
await++ 
_context++	 
.++ 
SaveChangesAsync++ "
(++" #
)++# $
;++$ %
return,, 	
CreatedAtAction,,
 
(,, 
nameof,,  
(,,  !
	GetDoctor,,! *
),,* +
,,,+ ,
new,,- 0
{,,1 2
id,,3 5
=,,6 7
doctor,,8 >
.,,> ?
	id_doctor,,? H
},,I J
,,,J K
doctor,,L R
),,R S
;,,S T
}-- 
[// 
HttpPut// 

(//
 
$str// 
)// 
]// 
public00 
async00	 
Task00 
<00 
IActionResult00 !
>00! "
	PutDoctor00# ,
(00, -
int00- 0
id001 3
,003 4
[005 6
FromBody006 >
]00> ?
Doctor00@ F
doctor00G M
)00M N
{11 
if22 
(22 
id22 	
!=22
 
doctor22 
.22 
	id_doctor22 
)22 
{33 
return44 


BadRequest44 
(44 
$str44 Y
)44Y Z
;44Z [
}55 
if77 
(77 
!77 

ModelState77 
.77 
IsValid77 
)77 
{88 
return99 


BadRequest99 
(99 

ModelState99  
)99  !
;99! "
}:: 
_context<< 
.<< 
Entry<< 
(<< 
doctor<< 
)<< 
.<< 
State<< 
=<<  !
EntityState<<" -
.<<- .
Modified<<. 6
;<<6 7
try>> 
{?? 
await@@ 	
_context@@
 
.@@ 
SaveChangesAsync@@ #
(@@# $
)@@$ %
;@@% &
}AA 
catchBB 
(BB	 
(
DbUpdateConcurrencyExceptionBB
 &
)BB& '
{CC 
ifDD 
(DD 
!DD 	
DoctorExistsDD	 
(DD 
idDD 
)DD 
)DD 
{EE 
returnFF 
NotFoundFF 
(FF 
)FF 
;FF 
}GG 
elseHH 
{II 
throwJJ 

;JJ
 
}KK 
}LL 
returnNN 	
	NoContentNN
 
(NN 
)NN 
;NN 
}OO 
privateQQ 	
boolQQ
 
DoctorExistsQQ 
(QQ 
intQQ 
idQQ  "
)QQ" #
{RR 
returnSS 	
_contextSS
 
.SS 
DoctoresSS 
.SS 
AnySS 
(SS  
eSS  !
=>SS" $
eSS% &
.SS& '
	id_doctorSS' 0
==SS1 3
idSS4 6
)SS6 7
;SS7 8
}TT 
[WW 

HttpDeleteWW 
(WW 
$strWW 
)WW 
]WW 
publicXX 
asyncXX	 
TaskXX 
<XX 
IActionResultXX !
>XX! "
DeleteDoctorXX# /
(XX/ 0
intXX0 3
idXX4 6
)XX6 7
{YY 
varZZ 
doctorZZ 
=ZZ 
awaitZZ 
_contextZZ 
.ZZ 
DoctoresZZ '
.ZZ' (
	FindAsyncZZ( 1
(ZZ1 2
idZZ2 4
)ZZ4 5
;ZZ5 6
if[[ 
([[ 
doctor[[ 
==[[ 
null[[ 
)[[ 
return[[ 
NotFound[[ &
([[& '
)[[' (
;[[( )
_context\\ 
.\\ 
Doctores\\ 
.\\ 
Remove\\ 
(\\ 
doctor\\ "
)\\" #
;\\# $
await]] 
_context]]	 
.]] 
SaveChangesAsync]] "
(]]" #
)]]# $
;]]$ %
return^^ 	
	NoContent^^
 
(^^ 
)^^ 
;^^ 
}__ 
}`` 
}aa ìK
TC:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\Controllers\CitasController.cs
	namespace 	
CitasMedicas
 
. 
Controllers "
{ 
[		 
ApiController		 
]		 
[

 
Route

 
(

 
$str

 
)

 
]

 
public 
class 
CitasController 
: 
ControllerBase  .
{ 
private 	
readonly
 
AppDbContext 
_context  (
;( )
public 
CitasController	 
( 
AppDbContext %
context& -
)- .
{ 
_context 
= 
context 
; 
} 
[ 
HttpGet 

]
 
public 
async	 
Task 
< 
ActionResult  
<  !
IEnumerable! ,
<, -
Cita- 1
>1 2
>2 3
>3 4
GetCitas5 =
(= >
)> ?
{ 
return 	
await
 
_context 
. 
Citas 
. 
Include &
(& '
c' (
=>) +
c, -
.- .
Paciente. 6
)6 7
. 
Include 
( 
c 
=> 
c 
. 
Doctor "
)" #
. 
ToListAsync 
( 
) 
; 
} 
[ 
HttpGet 

(
 
$str 
) 
] 
public 
async	 
Task 
< 
ActionResult  
<  !
Cita! %
>% &
>& '
GetCita( /
(/ 0
int0 3
id4 6
)6 7
{ 
var 
cita 
= 
await 
_context 
. 
Citas "
." #
Include# *
(* +
c+ ,
=>- /
c0 1
.1 2
Paciente2 :
): ;
.   
Include   
(   
c   
=>   
c   
.   
Doctor   #
)  # $
.!! 
FirstOrDefaultAsync!! !
(!!! "
c!!" #
=>!!$ &
c!!' (
.!!( )
id_cita!!) 0
==!!1 3
id!!4 6
)!!6 7
;!!7 8
if"" 
("" 
cita"" 
=="" 
null"" 
)"" 
return"" 
NotFound"" $
(""$ %
)""% &
;""& '
return## 	
cita##
 
;## 
}$$ 
[&& 
HttpPost&& 
]&& 
public'' 
async''	 
Task'' 
<'' 
ActionResult''  
<''  !
Cita''! %
>''% &
>''& '
PostCita''( 0
(''0 1
[''1 2
FromBody''2 :
]'': ;
Cita''< @
cita''A E
)''E F
{(( 
if)) 
()) 
!)) 

ModelState)) 
.)) 
IsValid)) 
))) 
{** 
return++ 


BadRequest++ 
(++ 

ModelState++  
)++  !
;++! "
},, 
var// 
doctor// 
=// 
await// 
_context// 
.// 
Doctores// '
.//' (
	FindAsync//( 1
(//1 2
cita//2 6
.//6 7
	id_doctor//7 @
)//@ A
;//A B
var00 
paciente00 
=00 
await00 
_context00  
.00  !
	Pacientes00! *
.00* +
	FindAsync00+ 4
(004 5
cita005 9
.009 :
id_paciente00: E
)00E F
;00F G
if22 
(22 
doctor22 
==22 
null22 
||22 
paciente22 !
==22" $
null22% )
)22) *
{33 
return44 


BadRequest44 
(44 
$str44 8
)448 9
;449 :
}55 
DateTime77 

fechaDeHoy77 
=77 
DateTime77 !
.77! "
Today77" '
;77' (
if:: 
(:: 
cita:: 
.:: 

fecha_hora:: 
<:: 

fechaDeHoy:: #
)::# $
{;; 
return<< 


BadRequest<< 
(<< 
$str<< '
)<<' (
;<<( )
}== 
bool@@ 
citaExistente@@ 
=@@ 
await@@ 
_context@@ &
.@@& '
Citas@@' ,
.AA 
AnyAsyncAA 
(AA 
cAA 
=>AA 
cAA 
.AA 

fecha_horaAA '
==AA( *
citaAA+ /
.AA/ 0

fecha_horaAA0 :
&&AA; =
cAA> ?
.AA? @
	id_doctorAA@ I
==AAJ L
citaAAM Q
.AAQ R
	id_doctorAAR [
)AA[ \
;AA\ ]
ifCC 
(CC 
citaExistenteCC 
)CC 
{DD 
returnEE 

ConflictEE 
(EE 
$strEE L
)EEL M
;EEM N
}FF 
_contextHH 
.HH 
CitasHH 
.HH 
AddHH 
(HH 
citaHH 
)HH 
;HH 
awaitII 
_contextII	 
.II 
SaveChangesAsyncII "
(II" #
)II# $
;II$ %
returnJJ 	
CreatedAtActionJJ
 
(JJ 
nameofJJ  
(JJ  !
GetCitaJJ! (
)JJ( )
,JJ) *
newJJ+ .
{JJ/ 0
idJJ1 3
=JJ4 5
citaJJ6 :
.JJ: ;
id_citaJJ; B
}JJC D
,JJD E
citaJJF J
)JJJ K
;JJK L
}KK 
[OO 
HttpPutOO 

(OO
 
$strOO 
)OO 
]OO 
publicPP 
asyncPP	 
TaskPP 
<PP 
IActionResultPP !
>PP! "
PutCitaPP# *
(PP* +
intPP+ .
idPP/ 1
,PP1 2
[PP3 4
FromBodyPP4 <
]PP< =
CitaPP> B
citaPPC G
)PPG H
{QQ 
ifRR 
(RR 
idRR 	
!=RR
 
citaRR 
.RR 
id_citaRR 
)RR 
{SS 
returnTT 


BadRequestTT 
(TT 
$strTT Y
)TTY Z
;TTZ [
}UU 
ifWW 
(WW 
!WW 

ModelStateWW 
.WW 
IsValidWW 
)WW 
{XX 
returnYY 


BadRequestYY 
(YY 

ModelStateYY  
)YY  !
;YY! "
}ZZ 
_context\\ 
.\\ 
Entry\\ 
(\\ 
cita\\ 
)\\ 
.\\ 
State\\ 
=\\ 
EntityState\\  +
.\\+ ,
Modified\\, 4
;\\4 5
try^^ 
{__ 
await`` 	
_context``
 
.`` 
SaveChangesAsync`` #
(``# $
)``$ %
;``% &
}aa 
catchbb 
(bb	 
(
DbUpdateConcurrencyExceptionbb
 &
)bb& '
{cc 
ifdd 
(dd 
!dd 	

CitaExistsdd	 
(dd 
iddd 
)dd 
)dd 
{ee 
returnff 
NotFoundff 
(ff 
)ff 
;ff 
}gg 
elsehh 
{ii 
throwjj 

;jj
 
}kk 
}ll 
returnnn 	
	NoContentnn
 
(nn 
)nn 
;nn 
}oo 
privateqq 	
boolqq
 

CitaExistsqq 
(qq 
intqq 
idqq  
)qq  !
{rr 
returnss 	
_contextss
 
.ss 
Citasss 
.ss 
Anyss 
(ss 
ess 
=>ss !
ess" #
.ss# $
id_citass$ +
==ss, .
idss/ 1
)ss1 2
;ss2 3
}tt 
[yy 

HttpDeleteyy 
(yy 
$stryy 
)yy 
]yy 
publiczz 
asynczz	 
Taskzz 
<zz 
IActionResultzz !
>zz! "

DeleteCitazz# -
(zz- .
intzz. 1
idzz2 4
)zz4 5
{{{ 
var|| 
cita|| 
=|| 
await|| 
_context|| 
.|| 
Citas|| "
.||" #
	FindAsync||# ,
(||, -
id||- /
)||/ 0
;||0 1
if}} 
(}} 
cita}} 
==}} 
null}} 
)}} 
return}} 
NotFound}} $
(}}$ %
)}}% &
;}}& '
_context~~ 
.~~ 
Citas~~ 
.~~ 
Remove~~ 
(~~ 
cita~~ 
)~~ 
;~~ 
await 
_context	 
. 
SaveChangesAsync "
(" #
)# $
;$ %
return
ÄÄ 	
	NoContent
ÄÄ
 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÇÇ 
}ÉÉ ùP
EC:\Users\Admin\source\repos\CitasMedicas\CitasMedicas\AppDbContext.cs
	namespace 	
CitasMedicas
 
{ 
public 
class 
AppDbContext 
: 
	DbContext &
{		 
public

 
AppDbContext

	 
(

 
DbContextOptions

 &
<

& '
AppDbContext

' 3
>

3 4
options

5 <
)

< =
:

> ?
base

@ D
(

D E
options

E L
)

L M
{ 
} 
public 
DbSet	 
< 
Paciente 
> 
	Pacientes "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet	 
< 
Doctor 
> 
Doctores 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DbSet	 
< 
Cita 
> 
Citas 
{ 
get  
;  !
set" %
;% &
}' (
public 
DbSet	 
< 
Procedimiento 
> 
Procedimientos ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
	protected 
override 
void 
OnModelCreating )
() *
ModelBuilder* 6
modelBuilder7 C
)C D
{ 
modelBuilder 
. 
Entity 
< 
Cita 
> 
( 
) 
. 
HasOne 
( 
p 
=> 
p 
. 
Paciente 
) 
. 
WithMany 
( 
c 
=> 
c 
. 
Citas 
) 
. 
HasForeignKey 
( 
p 
=> 
p 
. 
id_paciente %
)% &
;& '
modelBuilder 
. 
Entity 
< 
Cita 
> 
( 
) 
. 
HasOne 
( 
d 
=> 
d 
. 
Doctor 
) 
. 
WithMany 
( 
c 
=> 
c 
. 
Citas 
) 
. 
HasForeignKey 
( 
d 
=> 
d 
. 
	id_doctor #
)# $
;$ %
modelBuilder   
.   
Entity   
<   
Procedimiento   $
>  $ %
(  % &
)  & '
.!! 
HasOne!! 
(!! 
c!! 
=>!! 
c!! 
.!! 
Cita!! 
)!! 
."" 
WithMany"" 
("" 
p"" 
=>"" 
p"" 
."" 
Procedimientos"" #
)""# $
.## 
HasForeignKey## 
(## 
c## 
=>## 
c## 
.## 
id_cita## !
)##! "
.$$ 
OnDelete$$ 
($$ 
DeleteBehavior$$ 
.$$ 
Cascade$$ $
)$$$ %
;$$% &
}%% 
public'' 
class''	 
Paciente'' 
{(( 
[)) 
Key)) 
])) 
public** 	
int**
 
?** 
id_paciente** 
{** 
get**  
;**  !
set**" %
;**% &
}**' (
[,, 
Required,, 
],, 
public-- 	
string--
 
?-- 
nombre-- 
{-- 
get-- 
;-- 
set--  #
;--# $
}--% &
[// 
Required// 
]// 
public00 	
string00
 
?00 
apellido00 
{00 
get00  
;00  !
set00" %
;00% &
}00' (
[22 
Required22 
]22 
public33 	
DateTime33
 
?33 
fecha_nacimiento33 $
{33% &
get33' *
;33* +
set33, /
;33/ 0
}331 2
public55 	
string55
 
?55 
telefono55 
{55 
get55  
;55  !
set55" %
;55% &
}55' (
public66 	
string66
 
?66 
	direccion66 
{66 
get66 !
;66! "
set66# &
;66& '
}66( )
[88 
EmailAddress88 
]88 
public99 	
string99
 
?99 
correo99 
{99 
get99 
;99 
set99  #
;99# $
}99% &
public<< 	
ICollection<<
 
<<< 
Cita<< 
><< 
Citas<< !
{<<" #
get<<$ '
;<<' (
set<<) ,
;<<, -
}<<. /
=<<0 1
new<<2 5
List<<6 :
<<<: ;
Cita<<; ?
><<? @
(<<@ A
)<<A B
;<<B C
}== 
public@@ 
class@@	 
Doctor@@ 
{AA 
[BB 
KeyBB 
]BB 
publicCC 	
intCC
 
?CC 
	id_doctorCC 
{CC 
getCC 
;CC 
setCC  #
;CC# $
}CC% &
[EE 
RequiredEE 
]EE 
publicFF 	
stringFF
 
?FF 
nombreFF 
{FF 
getFF 
;FF 
setFF  #
;FF# $
}FF% &
[HH 
RequiredHH 
]HH 
publicII 	
stringII
 
?II 
apellidoII 
{II 
getII  
;II  !
setII" %
;II% &
}II' (
[KK 
RequiredKK 
]KK 
publicLL 	
stringLL
 
?LL 
especialidadLL 
{LL  
getLL! $
;LL$ %
setLL& )
;LL) *
}LL+ ,
publicNN 	
stringNN
 
?NN 
telefonoNN 
{NN 
getNN  
;NN  !
setNN" %
;NN% &
}NN' (
publicOO 	
stringOO
 
?OO 
correoOO 
{OO 
getOO 
;OO 
setOO  #
;OO# $
}OO% &
publicRR 	
ICollectionRR
 
<RR 
CitaRR 
>RR 
CitasRR !
{RR" #
getRR$ '
;RR' (
setRR) ,
;RR, -
}RR. /
=RR0 1
newRR2 5
ListRR6 :
<RR: ;
CitaRR; ?
>RR? @
(RR@ A
)RRA B
;RRB C
}SS 
publicUU 
classUU	 
CitaUU 
{VV 
[WW 
KeyWW 
]WW 
publicXX 	
intXX
 
?XX 
id_citaXX 
{XX 
getXX 
;XX 
setXX !
;XX! "
}XX# $
[ZZ 
RequiredZZ 
]ZZ 
public[[ 	
int[[
 
?[[ 
id_paciente[[ 
{[[ 
get[[  
;[[  !
set[[" %
;[[% &
}[[' (
[]] 
Required]] 
]]] 
public^^ 	
int^^
 
?^^ 
	id_doctor^^ 
{^^ 
get^^ 
;^^ 
set^^  #
;^^# $
}^^% &
[`` 
Required`` 
]`` 
publicaa 	
DateTimeaa
 
?aa 

fecha_horaaa 
{aa  
getaa! $
;aa$ %
setaa& )
;aa) *
}aa+ ,
publiccc 	
stringcc
 
?cc 
estadocc 
{cc 
getcc 
;cc 
setcc  #
;cc# $
}cc% &
publicdd 	
stringdd
 
?dd 
descripciondd 
{dd 
getdd  #
;dd# $
setdd% (
;dd( )
}dd* +
publicgg 	
virtualgg
 
Pacientegg 
?gg 
Pacientegg $
{gg% &
getgg' *
;gg* +
setgg, /
;gg/ 0
}gg1 2
publichh 	
virtualhh
 
Doctorhh 
?hh 
Doctorhh  
{hh! "
gethh# &
;hh& '
sethh( +
;hh+ ,
}hh- .
publicii 	
virtualii
 
ICollectionii 
<ii 
Procedimientoii +
>ii+ ,
?ii, -
Procedimientosii. <
{ii= >
getii? B
;iiB C
setiiD G
;iiG H
}iiI J
}jj 
publicnn 
classnn	 
Procedimientonn 
{oo 
[pp 
Keypp 
]pp 
publicqq 	
intqq
 
?qq 
id_procedimientoqq 
{qq  !
getqq" %
;qq% &
setqq' *
;qq* +
}qq, -
[ss 
Requiredss 
]ss 
publictt 	
stringtt
 
?tt 
descripciontt 
{tt 
gettt  #
;tt# $
settt% (
;tt( )
}tt* +
[vv 
Requiredvv 
]vv 
publicww 	
decimalww
 
?ww 
costoww 
{ww 
getww 
;ww 
setww  #
;ww# $
}ww% &
[yy 
Requiredyy 
]yy 
publiczz 	
intzz
 
?zz 
id_citazz 
{zz 
getzz 
;zz 
setzz !
;zz! "
}zz# $
public}} 	
virtual}}
 
Cita}} 
?}} 
Cita}} 
{}} 
get}} "
;}}" #
set}}$ '
;}}' (
}}}) *
}~~ 
}
ÄÄ 
}ÅÅ 